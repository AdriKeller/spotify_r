---
title: "Factors for popularity of music"
subtitle: "An analysis of popular music on Spotify."
author: "Filipe Jung, Adrian Keller"
date: "2025-11-21"
output: 
  html_document:
    toc: true
    toc_depth: 3
    number_sections: true
    toc_float: true
    code_folding: hide
    theme: flatly
    highlight: tango
    code_download: true
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# The Data

The data we are using is from TidyTuesday. The data includes various statistics on 32833 popular Spotify songs (e.g. date, genre, popularity, key, energy, album, etc.). Our goal is to find interesting correlations on how the different statistics relate, especially within and between certain genres. There is no missing data, but certain data quirks have to be considered when looking at statistics. The list of different columns can be seen in the list below

```{r cars, include=FALSE}
library(readr)
library(tidyverse)
library(ggplot2)
spotify_songs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-01-21/spotify_songs.csv')
```

```{r data headers}

names(spotify_songs)

```

## Data on popularity

Looking at the distribution of popularity of these songs, it is easy to see that songs with lower popularity seem to fill a large part of the data.

```{r pop plot, echo=FALSE}
ggplot(data = spotify_songs, aes(x=track_popularity))+
  geom_bar()
```

For better analysis in relation with the popularity of the songs, we thought it would make sense to exclude songs with low popularity.

```{r pop plot filter, echo=FALSE}
spotify_songs_filter = spotify_songs %>%
  dplyr::filter(track_popularity>5)
ggplot(data = spotify_songs_filter, aes(x=track_popularity))+
  geom_bar()
```

## Summary of genres

Comparing the statistics for different genres

```{r genre, echo=FALSE}
genre_filter_edm <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="edm")
genre_filter_latin <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="latin")
genre_filter_pop <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="pop")
genre_filter_latin <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="r&b")
genre_filter_edm <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="rap")
genre_filter_latin <- spotify_songs_filter %>% 
  dplyr::filter(playlist_genre=="rock")

genre_filter_mean <- mean(c(genre_filter_edm, genre_filter_latin))
  
ggplot(data.frame(mean = mean(spotify_songs_filter$track_popularity), question = spotify_songs_filter$playlist_genre)) +
      geom_col(aes(question, mean))
```

## Visualisation of possible indicators

```{r show ridgeplot, echo=FALSE}
library(tidyverse)

spotify_songs_stats = pivot_longer(
  spotify_songs %>% select(track_popularity, danceability, energy, speechiness, acousticness, instrumentalness, liveness, valence),
  cols = danceability:valence, names_to = "value_name", values_to = "value"
)

library(ggridges)

ggplot(spotify_songs_stats, aes(track_popularity, y=fct_reorder(value_name, value), group=value_name, height=value)) +
  geom_ridgeline(
    alpha = 0.4,
    fill = "#05595b",
    color = "white"
  )+
  labs(title = "", x = "Popularity", y = "")
  
```

# References

```{r references, echo=FALSE}
library(report)

report(sessionInfo())
```
